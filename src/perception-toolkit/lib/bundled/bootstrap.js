/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

if(!self.perceptionToolkitLoader){const e=async e=>{if(!t[e]&&(await new Promise(async o=>{if("document"in self){const t=document.createElement("script");t.src=function(){let e="";return window.PerceptionToolkit&&window.PerceptionToolkit.config&&window.PerceptionToolkit.config.root&&(e=window.PerceptionToolkit.config.root),`${e}/lib/bundled`}()+e.slice(1),t.defer=!0,document.head.appendChild(t),t.onload=o}else importScripts(e),o()}),!t[e]))throw new Error(`Module ${e} didnâ€™t register its module`);return t[e]},o=async(o,t)=>{const n=await Promise.all(o.map(e));t(1===n.length?n[0]:n)},t={require:Promise.resolve(o)};self.perceptionToolkitLoader=((o,n,i)=>{t[o]||(t[o]=new Promise(async o=>{let t={};const r={uri:location.origin+function(){let e="";return window.PerceptionToolkit&&window.PerceptionToolkit.config&&window.PerceptionToolkit.config.root&&(e=window.PerceptionToolkit.config.root),`${e}/lib/bundled`}()+name.slice(1)},s=await Promise.all(n.map(o=>"exports"===o?t:"module"===o?r:e(o))),a=i(...s);t.default||(t.default=a),o(t)}))})}perceptionToolkitLoader("./bootstrap.js",["require","./pt-chunk-2c2752b3.js","./pt-chunk-bc29be45.js","./pt-chunk-d3dcaf5d.js"],function(e,o,t,n){"use strict";class i{constructor(){this.useEvents=!1,this.detectors=new Map}addDetector(e){const{name:o,supported:t}=e;if(this.detectors.has(o))throw new Error(`${o} already added`);this.detectors.set(o,t)}removeDetector(e){this.detectors.delete(e)}async detect(){const e={};for(const[o,t]of this.detectors)e[o]=await t();return this.useEvents&&t.fire(i.supportsEvent,self,e),e}}i.supportsEvent="supports";const r={name:"getUserMedia",supported:async()=>"mediaDevices"in self.navigator&&"getUserMedia"in self.navigator.mediaDevices},s={name:"wasm",supported:async()=>"WebAssembly"in self},a="pt.devicenotsupported";window.PerceptionToolkit.config=window.PerceptionToolkit.config||{},window.PerceptionToolkit.Events={CameraAccessDenied:o.cameraAccessDenied,CaptureClosed:o.closeEvent,CaptureStopped:o.captureStopped,DeviceNotSupported:a,MarkerChanges:o.markerChanges},window.PerceptionToolkit.Elements={ActionButton:o.ActionButton,Card:o.Card},window.PerceptionToolkit.Functions={initializeExperience:d,closeExperience(){}},window.PerceptionToolkit.config.onload&&window.PerceptionToolkit.config.onload.call(null);const c=new Promise(async o=>{const{config:t}=window.PerceptionToolkit,{showLoaderDuringBoot:n=!0}=t,a=new i;a.addDetector(r),a.addDetector(s);const c=await a.detect();if(c[r.name]&&c[s.name]){const{showLoader:i}=await new Promise(function(o,t){e(["./loader.js"],o,t)});n&&i(),t.onboarding&&t.onboardingImages&&await new Promise(function(o,t){e(["./onboarding.js"],o,t)}),o(!0)}else o(!1)});async function d(){if(!await c){const{hideLoader:o}=await new Promise(function(o,t){e(["./loader.js"],o,t)});return o(),void(t.fire(a,window).defaultPrevented||l({cls:"no-support",msg:"Sorry, this browser does not support the required features"}))}const{showLoader:o,hideLoader:n}=await new Promise(function(o,t){e(["./loader.js"],o,t)}),{config:i}=window.PerceptionToolkit,{sitemapUrl:r,detectionMode:s="passive"}=i;if(i&&i.onboardingImages&&i.onboarding){n();const{startOnboardingProcess:o}=await new Promise(function(o,t){e(["./onboarding.js"],o,t)});await o(i.onboardingImages)}o();const{initialize:d,close:w}=await new Promise(function(o,t){e(["./main.js"],o,t)});window.PerceptionToolkit.Functions.closeExperience=w,d({detectionMode:s,sitemapUrl:r})}function l({msg:e="",cls:t=""}){customElements.get(o.Card.defaultTagName)||customElements.define(o.Card.defaultTagName,o.Card);const{config:n}=window.PerceptionToolkit,{cardContainer:i=document.body}=n;if(i.querySelector(o.Card.defaultTagName))return;const r=new o.Card;r.classList.add(t),r.src=e,i.appendChild(r)}!async function(){const t=await c,{hideLoader:n,showLoader:i}=await new Promise(function(o,t){e(["./loader.js"],o,t)}),{config:r}=window.PerceptionToolkit,{buttonVisibilityClass:s="visible"}=r,a=r.button?r.button:r.buttonSelector?document.body.querySelector(r.buttonSelector):null;n(),a&&(a.classList.toggle(s,t),a.addEventListener("click",e=>{t?(i(),a.classList.remove(s),d()):l({cls:"no-support",msg:"Sorry, this browser does not support the required features"})}),window.addEventListener(o.captureStopped,()=>{a.classList.add(s)}))}()});
